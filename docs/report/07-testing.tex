\FloatBarrier\section{Testing}\label{sec:testing}

\subsection{Unit Testing}
Unit tests are implemented using \textbf{Pytest}, initializing Flask application contexts and test clients, and are located in the \texttt{tests/} directory.

Dependencies such as database sessions or external API calls are managed via isolated test databases or mocked where necessary to ensure speed and determinism.

\subsection{Isolation Testing}
Isolation tests are designed with specific Docker Compose files, and are located in the\newline\mbox{\texttt{tests/compose}} directory.

We use \textbf{Newman} to execute comprehensive API test suites defined in \mbox{\texttt{docs/postman/}}. These tests validate the OpenAPI contract, checking status codes, headers, and JSON schemas against the running container.

In addition, all the databases intended for the isolation tests, and related to each single microservice, are mocked using \textbf{SQLite} in-memory databases to ensure fast and reliable test execution.

In order to test Game Engine Service, we mock the communication with Card Catalogue Service and avoid the communication with Players Service, so that it is possible to verify the correct behavior of the game logic without relying on the actual services.
For instance, the cards are loaded directly from the JSON file.

\subsection{System and Integration Testing}
A dedicated Postman collection, located in \mbox{\texttt{docs/\allowbreak\_postman/}}, orchestrates complex user flows that span multiple services, such as a user registering and logging (Authentication Service), player profile creation (Player Service), joining and playing a match (Matchmaking Service and Game Engine Service).

\paragraph{Continuous Integration}~\\
The testing process is fully automated via \textbf{GitHub Actions}. The pipeline defines specific jobs for each testing stage:
\begin{enumerate}
    \item \textbf{unit-tests}: Runs the Pytest suite on the codebase.
    \item \textbf{*-isolation-tests}: Builds individual service images, spins them up, and runs Newman.
    \item \textbf{static-analysis \& build-and-scan}: Executes security audits and vulnerability scans.
\end{enumerate}
